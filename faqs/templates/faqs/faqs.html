{% extends "base.html" %}
{% load static %}

{% block content %}
<div class="container faq-page mb-5">
  <h1 class="mb-4">Frequently Asked Questions</h1>

  {% if faqs %}
    <div id="faqAccordion" class="accordion">
      {% for f in faqs %}
        <div class="card mb-2">
          <div class="card-header p-0" id="faq-heading-{{ f.id }}">
            <button
              class="btn btn-link btn-block text-left py-3 px-3 faq-toggle"
              type="button"
              data-toggle="collapse"
              data-target="#faq-panel-{{ f.id }}"
              aria-expanded="false"
              aria-controls="faq-panel-{{ f.id }}"
            >
              <span class="font-weight-bold">{{ f.question }}</span>
            </button>
          </div>

          <div
            id="faq-panel-{{ f.id }}"
            class="collapse"
            role="region"
            aria-labelledby="faq-heading-{{ f.id }}"
            data-parent="#faqAccordion"
          >
            <div class="card-body">
              {{ f.answer|linebreaks }}
              {% if request.user.is_superuser %}
                <hr>
                <div class="d-flex gap-2">
                  <a href="{% url 'faqs:update_faq' id=f.id %}" class="btn btn-sm btn-outline-success">Update</a>
                  <a href="{% url 'faqs:delete_faq' id=f.id %}" class="btn btn-sm btn-outline-danger">Delete</a>
                </div>
              {% endif %}
            </div>
          </div>
        </div>
      {% endfor %}
    </div>
  {% else %}
    <p>No FAQs yet.</p>
  {% endif %}

  {% if request.user.is_superuser %}
    <div class="mt-4">
      <a class="btn btn-success" href="{% url 'faqs:add_faq' %}">Add FAQ</a>
    </div>
  {% endif %}
</div>
{% endblock %}

{% block postloadjs %}
  {{ block.super }}
  <script>
    // Keyboard toggle helper for accessibility
    document.querySelectorAll('.faq-toggle').forEach(btn => {
      btn.addEventListener('keydown', e => {
        if (e.key === 'Enter' || e.key === ' ') { e.preventDefault(); btn.click(); }
      });
    });
  </script>
 
{% endblock %}
